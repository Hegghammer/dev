// To get useful RStudio keybindings like ALT + - for assignment operator,
// replace contents of existing `keybindings.json` with the below.

// To open `keybindings.json`, press F1, type "keyboard", and 
// select "Preferences: Open Keyboard Shortcuts (JSON)"
[
    // New keybinding for close tab, since CTRL + W is used by the browser
    {
        "key": "ctrl+alt+w",
        "command": "workbench.action.closeActiveEditor"
    },
    {
        "key": "ctrl+w",
        "command": "-workbench.action.closeActiveEditor"
    },
    
    // Toggle comment
    {
        "key": "ctrl+shift+c",
        "command": "editor.action.commentLine",
        "when": "editorTextFocus && !editorReadonly"
    },
    {
        "key": "ctrl+shift+7",
        "command": "-editor.action.commentLine",
        "when": "editorTextFocus && !editorReadonly"
    },

    // Insert assignment operator
    {
        "key": "alt+.",
        "command": "editor.action.insertSnippet",
        "args": { "snippet": " <- " },
        "when": "editorTextFocus",
    },
    {
        "key": "alt+.",
        "command": "workbench.action.terminal.sendSequence",
        "args": { "text": " <- " },
        "when": "terminalFocus"
      },
    // Insert piping operator
    {
        "key": "ctrl+shift+m",
        "command": "editor.action.insertSnippet",
        "args": { "snippet": " |> " },
        "when": "editorTextFocus",
    },
    {
        "key": "ctrl+shift+m",
        "command": "workbench.action.terminal.sendSequence",
        "args": { "text": " |> " },
        "when": "terminalFocus"
      },


    // Insert r code chunk
    {
        "key": "ctrl+alt+i",
        "command": "editor.action.insertSnippet",
        "when": "editorTextFocus",
        "args": {
            "snippet": "```{r}\n$0\n```"
        }
    },

    // Render Quarto document
    {
        "key": "ctrl+alt+r",
        "command": "quarto.renderDocument",
        "when": "editorTextFocus"
    },

    // Render Quarto document
    {
        "key": "ctrl+alt+p",
        "command": "quarto.preview",
        "when": "editorTextFocus"
    },

    // Open R help for selection
    {
        "key": "ctrl+alt+h",
        "command": "r.helpPanel.openForSelection"
    },
    // Rebind Format Document since it conflicts with Quarto insert code cell
    {
        "key": "ctrl+k ctrl+f",
        "command": "editor.action.formatDocument",
        "when": "editorHasDocumentFormattingProvider && editorTextFocus && !editorReadonly && !inCompositeEditor"
    },
    {
        "key": "ctrl+shift+i",
        "command": "-editor.action.formatDocument",
        "when": "editorHasDocumentFormattingProvider && editorTextFocus && !editorReadonly && !inCompositeEditor"
    }
]
